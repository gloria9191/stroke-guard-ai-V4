<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>StrokeGuard AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Yoon+Gothic+700:wght@700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <style>
        body {margin:0;background:#0f0f23;color:white;font-family:'Noto Sans KR',sans-serif;overflow-x:hidden}
        .hero{min-height:100vh;background:linear-gradient(135deg,#0f0f23,#1a1a3a,#2d1b69);display:flex;align-items:center;justify-content:center;position:relative}
        .hero::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('https://images.unsplash.com/photo-1638207213803-3c093c7cd506?ixlib=rb-4.0.3&auto=format&fit=crop&q=80') center/cover;opacity:0.15}
        .hero-content{position:relative;z-index:2;max-width:900px;text-align:center;padding:0 20px;}
        .title{font-size:clamp(4rem,10vw,7rem);font-weight:900;letter-spacing:-3px;margin:0 0 1.5rem;line-height:0.9;font-family:'Yoon Gothic 700',sans-serif}
        .stroke{background:linear-gradient(90deg,#ff6b6b,#feca57);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .guard{color:#a29bfe;text-shadow:0 0 30px rgba(162,155,254,0.6)}
        .subtitle{font-size:1.5rem;font-weight:300;margin:0 0 3rem;opacity:0.9;line-height:1.7}
        .badges{display:flex;flex-wrap:wrap;gap:14px;justify-content:center;margin:0 0 4rem}
        .badge{background:rgba(255,255,255,0.12);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2);padding:10px 24px;border-radius:50px;font-weight:500;transition:all 0.3s}
        .badge:hover{background:rgba(162,155,254,0.3);transform:translateY(-3px)}
        .tagline{font-size:1.4rem;font-weight:400;opacity:0.9;margin-bottom:80px;}
        .icon{margin-right:12px;background:linear-gradient(135deg,#54a0ff,#a29bfe);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:1.2rem!important}
        .animated-hint{position:absolute;bottom:40px;left:0;right:0;text-align:center;font-size:1.2rem;opacity:.75;animation:scrollFade 1.8s infinite ease-in-out}
        @keyframes scrollFade{0%{opacity:.3;transform:translateY(0)}50%{opacity:1;transform:translateY(6px)}100%{opacity:.3;transform:translateY(0)}}
        .card{background:rgba(255,255,255,0.95);color:#333;border-radius:28px;box-shadow:0 20px 60px rgba(80,40,150,0.2);}
        .btn-opt{width:48%;padding:22px;font-size:1.4rem;border:3px solid #6c5ce7;border-radius:20px;background:white;color:#6c5ce7;font-weight:700}
        .btn-opt.active,.btn-opt:hover{background:#6c5ce7;color:white}
        .btn-step{background:linear-gradient(135deg,#a29bfe,#6c5ce7);color:white;padding:18px 70px;border-radius:50px;font-size:1.4rem;font-weight:700}
        .progress{height:12px;border-radius:12px;background:#e0e0e0}
        .progress-bar{background:linear-gradient(90deg,#a29bfe,#6c5ce7)}

        /* ê²°ê³¼ ìƒ‰ìƒ 3ë‹¨ê³„ */
        .result-high{background:#ff4d4d!important;color:white!important}
        .result-mid{background:#feca57!important;color:white!important}
        .result-low{background:#3aa0ff!important;color:white!important}

        #resultCard{background:rgba(255,255,255,0.05);color:white;border-radius:30px}
        .result-text-box{font-size:1.3rem;line-height:1.7;margin-top:20px;opacity:.95}
    </style>
</head>

<body>

<!-- HERO -->
<div class="hero">
    <div class="hero-content">
        <h1 class="title"><span class="stroke">Stroke</span><span class="guard">Guard</span> AI</h1>
        <p class="subtitle">êµ­ë‚´ 500ë§Œ ëª… + ë¯¸êµ­ ë¼ë²¨ë§ ë°ì´í„°ë¡œ í•™ìŠµí•œ<br>ì°¨ì„¸ëŒ€ ë‡Œì¡¸ì¤‘ ì˜ˆì¸¡ AI</p>

        <div class="badges">
            <span class="badge">êµ­ë‚´ì™¸ ê¸°ë°˜ í•™ìŠµ ëª¨ë¸</span>
            <span class="badge">ë‡Œì¡¸ì¤‘ ìœ„í—˜ ì‹ í˜¸ ì¡°ê¸° ê°ì§€</span>
            <span class="badge">ì‹¤ì‹œê°„ AI ê±´ê°• ì½”ì¹­</span>
        </div>

        <div class="animated-hint">â¬‡ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•˜ì—¬ ì„¤ë¬¸ì„ ì‹œì‘í•˜ì„¸ìš”</div>
        <p class="tagline"><span class="icon">SYNAPSE</span>ì‘ì€ ë³€í™”ê°€ í° ë¯¸ë˜ë¥¼ ë§Œë“­ë‹ˆë‹¤</p>
    </div>
</div>


<!-- SURVEY (ê·¸ëŒ€ë¡œ ìœ ì§€) -->
<div class="container my-5" id="survey">
    <div class="row justify-content-center">
        <div class="col-lg-9">
            <div class="card p-5">

                <div class="progress mb-5"><div class="progress-bar" id="prog" style="width:12.5%"></div></div>

                <h2 class="text-center mb-5" id="question">1/8 ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h2>

                <div id="step1" class="text-center mb-4 step-block">
                    <button class="btn-opt active" data-value="1">ë‚¨ì„±</button>
                    <button class="btn-opt" data-value="0">ì—¬ì„±</button>
                </div>

                <div id="step2" class="d-none step-block text-center">
                    <input type="number" id="age" class="form-control form-control-lg text-center" placeholder="ë§Œ ë‚˜ì´ (ì˜ˆ: 45)">
                </div>

                <div id="step3" class="d-none step-block text-center">
                    <input type="number" id="height" class="form-control form-control-lg text-center" placeholder="í‚¤ (cm)">
                    <input type="number" id="weight" class="form-control form-control-lg text-center mt-3" placeholder="ëª¸ë¬´ê²Œ (kg)">
                </div>

                <div id="step4" class="d-none step-block text-center">
                    <input type="number" id="sbp" class="form-control form-control-lg text-center" placeholder="ìˆ˜ì¶•ê¸° í˜ˆì•• (ì˜ˆ: 130)">
                </div>

                <div id="step5" class="d-none step-block text-center">
                    <input type="number" id="dbp" class="form-control form-control-lg text-center" placeholder="ì´ì™„ê¸° í˜ˆì•• (ì˜ˆ: 85)">
                </div>

                <div id="step6" class="d-none step-block text-center">
                    <input type="number" id="glucose" class="form-control form-control-lg text-center" placeholder="ê³µë³µ í˜ˆë‹¹ (ì˜ˆ: 110)">
                </div>

                <div id="step7" class="d-none step-block text-center mb-4">
                    <button class="btn-opt active" data-value="0">ë¹„í¡ì—°</button>
                    <button class="btn-opt" data-value="1">í¡ì—°</button>
                </div>

                <div id="step8" class="d-none step-block text-center mb-4">
                    <button class="btn-opt active" data-value="0">ì£¼ 1íšŒ ë¯¸ë§Œ</button>
                    <button class="btn-opt" data-value="1">ì£¼ 1íšŒ ì´ìƒ</button>
                </div>

                <div class="text-center mt-5">
                    <button id="prev" class="btn btn-outline-secondary btn-lg me-4 d-none">ì´ì „</button>
                    <button id="next" class="btn btn-step">ë‹¤ìŒ</button>
                    <button id="submit" class="btn btn-danger btn-lg d-none">ì§€ê¸ˆ ì˜ˆì¸¡í•˜ê¸°</button>
                </div>

            </div>
        </div>
    </div>
</div>


<!-- RESULT -->
<div class="container my-5 d-none" id="result">
    <div class="row justify-content-center">
        <div class="col-lg-9">
            <div class="card p-5 text-white text-center" id="resultCard"></div>

            <!-- ğŸ”¥ ë¶„ë¥˜ ê¸°ì¤€ ì•ˆë‚´ (ì¶”ê°€ë¨) -->
            <div class="text-center mt-4" style="opacity:0.85;font-size:1rem;">
                <p>[ìœ„í—˜êµ° ë¶„ë¥˜ ê¸°ì¤€ ì•ˆë‚´]</p>
                <p>ì €ìœ„í—˜: 0% ~ 1.0%</p>
                <p>ì¤‘ìœ„í—˜: 1.1% ~ 3.0%</p>
                <p>ê³ ìœ„í—˜: 3.1% ì´ìƒ</p>
            </div>
        </div>
    </div>
</div>



<script>
/* ê¸°ì¡´ ë²„íŠ¼ active ìœ ì§€ */
document.querySelectorAll(".step-block .btn-opt").forEach(btn=>{
    btn.addEventListener("click",function(){
        const group=this.closest(".step-block").querySelectorAll(".btn-opt");
        group.forEach(b=>b.classList.remove("active"));
        this.classList.add("active");
    });
});

/* ì§ˆë¬¸ ë°°ì—´ ê·¸ëŒ€ë¡œ */
const questions=[
    "ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”",
    "ë§Œ ë‚˜ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”",
    "í‚¤ì™€ ëª¸ë¬´ê²Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”",
    "ìˆ˜ì¶•ê¸° í˜ˆì••ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",
    "ì´ì™„ê¸° í˜ˆì••ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",
    "ê³µë³µ í˜ˆë‹¹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”",
    "í¡ì—° ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”",
    "ìŒì£¼ ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"
];

let step=1;
const data={gender:1, smoking:0, drinking:0};

/* next ë²„íŠ¼ ë¡œì§ ê·¸ëŒ€ë¡œ */
document.getElementById("next").onclick=()=>{

    if(step===1) data.gender=Number(document.querySelector("#step1 .active").dataset.value);

    if(step===2){
        let v=document.getElementById("age").value;
        if(!v) return alert("ë§Œ ë‚˜ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");
        data.age=Number(v);
    }

    if(step===3){
        let h=Number(document.getElementById("height").value);
        let w=Number(document.getElementById("weight").value);
        if(!h || !w) return alert("í‚¤Â·ëª¸ë¬´ê²Œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”");
        data.bmi=Number((w/((h/100)**2)).toFixed(1));
    }

    if(step===4){
        let v=document.getElementById("sbp").value;
        if(!v) return alert("ìˆ˜ì¶•ê¸° í˜ˆì••ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
        data.sbp=Number(v);
    }

    if(step===5){
        let v=document.getElementById("dbp").value;
        if(!v) return alert("ì´ì™„ê¸° í˜ˆì••ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
        data.dbp=Number(v);
    }

    if(step===6){
        let v=document.getElementById("glucose").value;
        if(!v) return alert("ê³µë³µ í˜ˆë‹¹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
        data.glucose=Number(v);
    }

    if(step===7){
        data.smoking=Number(document.querySelector("#step7 .active").dataset.value);
    }

    if(step===8){
        data.drinking=Number(document.querySelector("#step8 .active").dataset.value);
    }

    if(step<8){
        document.getElementById(`step${step}`).classList.add("d-none");
        step++;
        document.getElementById(`step${step}`).classList.remove("d-none");
        document.getElementById("question").innerText=`${step}/8 ${questions[step-1]}`;
        document.getElementById("prog").style.width=`${(step/8)*100}%`;

        if(step>1) document.getElementById("prev").classList.remove("d-none");

        if(step===8){
            document.getElementById("next").classList.add("d-none");
            document.getElementById("submit").classList.remove("d-none");
        }
    }
};

/* prev ë²„íŠ¼ ê·¸ëŒ€ë¡œ */
document.getElementById("prev").onclick=()=>{
    document.getElementById(`step${step}`).classList.add("d-none");
    step--;
    document.getElementById(`step${step}`).classList.remove("d-none");
    document.getElementById("question").innerText=`${step}/8 ${questions[step-1]}`;
    document.getElementById("prog").style.width=`${(step/8)*100}%`;

    if(step===1) document.getElementById("prev").classList.add("d-none");

    document.getElementById("submit").classList.add("d-none");
    document.getElementById("next").classList.remove("d-none");
};


/* submit ë²„íŠ¼ */
document.getElementById("submit").onclick=()=>{

    if(Object.values(data).some(v=>v===undefined)){
        alert("ì…ë ¥ë˜ì§€ ì•Šì€ í•­ëª©ì´ ìˆìŠµë‹ˆë‹¤.");
        return;
    }

    document.getElementById("survey").classList.add("d-none");
    document.getElementById("result").classList.remove("d-none");

    document.getElementById("resultCard").innerHTML=`
        <h2>AI ë¶„ì„ ì¤‘...</h2>
        <div class="spinner-border text-light my-4" style="width:4rem;height:4rem"></div>
    `;

    fetch("/predict",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify(data)
    })
    .then(r=>r.json())
    .then(res=>{

        const card=document.getElementById("resultCard");

        /* ìœ„í—˜êµ° 3ë‹¨ê³„ ì ìš© */
        card.classList.remove("result-high","result-mid","result-low");
        card.classList.add(res.risk_class || "result-low");

        card.innerHTML=`
            <h1 class="display-1 fw-bold mb-3">${res.prob || 0}%</h1>
            <h2 class="display-5 mb-4">${res.risk_text || "ì €ìœ„í—˜"}êµ°</h2>

            <div class="result-text-box">${res.advice || "AI ì¡°ì–¸ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."}</div>

            <button class="btn btn-light btn-lg mt-5 px-5" onclick="location.reload()">ë‹¤ì‹œ ê²€ì‚¬í•˜ê¸°</button>
            
            <p class="mt-4" style="opacity:0.7;">ì¡°ì–¸ ìƒì„± ëª¨ë¸: Groq LLaMA-3.1-8B-Instant</p>
        `;
    })
    .catch(()=>{
        document.getElementById("resultCard").innerHTML=`
            <h2>ì„œë²„ ì˜¤ë¥˜ ë°œìƒ</h2>
            <button class="btn btn-light mt-4" onclick="location.reload()">ë‹¤ì‹œ ì‹œë„</button>
        `;
    });
};
</script>

</body>
</html>
